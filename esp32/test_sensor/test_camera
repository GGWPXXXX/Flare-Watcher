import cv2

def access_camera(ip_address, port, username=None, password=None):
    # Construct the RTSP URL with authentication if username and password are provided
    if username and password:
        rtsp_url = f"rtsp://{username}:{password}@{ip_address}:{port}/stream"
    else:
        rtsp_url = f"rtsp://{ip_address}:{port}/stream"

    # Open a connection to the camera
    cap = cv2.VideoCapture(rtsp_url)

    if not cap.isOpened():
        print("Cannot open camera")
        exit()

    try:
        while True:
            # Capture frame-by-frame
            ret, frame = cap.read()
            # If frame is read correctly ret is True
            if not ret:
                print("Can't receive frame (stream end?). Exiting ...")
                break
            # Display the resulting frame
            cv2.imshow('Camera Feed', frame)
            if cv2.waitKey(1) == ord('q'):
                break
    finally:
        # When everything done, release the capture
        cap.release()
        cv2.destroyAllWindows()

# Replace 'username' and 'password' with your camera's credentials, if required
access_camera('192.168.1.140', 554, 'Test', '024126838')
